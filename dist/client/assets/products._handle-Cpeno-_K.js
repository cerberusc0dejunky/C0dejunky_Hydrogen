import{r as C,h as L,L as H,w as X,u as G}from"./chunk-TMI4QPZX-voV0X6j3.js";import{j as a}from"./jsx-runtime-59Xd5K8P.js";import{y as J,_ as Q}from"./index-Ck7_0ybI.js";import{P as q}from"./ProductPrice-CC1Aj1s_.js";import{I as z}from"./Image-dewHdXBc.js";import{A as M}from"./AddToCartButton-CSobI2M-.js";import{u as k}from"./Aside-C1PG5IR-.js";import"./Money-BwnrHHOZ.js";const g=",",f={OPTION:":",END_OF_PREFIX:",",SEQUENCE_GAP:" ",RANGE:"-"},_=(()=>{const t=new Map;return function(e,n){var r;if(e.length===0)return!1;if(!t.has(n)){const o=new Set;for(const i of B(n)){o.add(i.join(g));for(let s=0;s<i.length;s++)o.add(i.slice(0,s+1).join(g))}t.set(n,o)}return!!((r=t.get(n))!=null&&r.has(e.join(g)))}})();function B(t){if(!t)return[];if(t.startsWith("v1_"))return Y(W(t));throw new Error("Unsupported option value encoding")}const W=t=>t.replace(/^v1_/,"");function Y(t){const e=/[ :,-]/g;let n=0,r;const o=[],i=[];let s=0,l=null;for(;r=e.exec(t);){const c=r[0],d=Number.parseInt(t.slice(n,r.index))||0;if(l!==null){for(;l<d;l++)i[s]=l,o.push([...i]);l=null}i[s]=d,c===f.RANGE?l=d:c===f.OPTION?s++:((c===f.SEQUENCE_GAP||c===f.END_OF_PREFIX&&t[r.index-1]!==f.END_OF_PREFIX)&&o.push([...i]),c===f.END_OF_PREFIX&&(i.pop(),s--)),n=e.lastIndex}const u=t.match(/\d+$/g);if(u){const c=parseInt(u[0]);if(l!=null)for(;l<=c;l++)i[s]=l,o.push([...i]);else o.push([c])}return o}function Z(t){return Object.assign({},...t.map(e=>({[e.name]:Object.assign({},...e!=null&&e.optionValues?e.optionValues.map((n,r)=>({[n.name]:r})):[])})))}function b(t){return Object.assign({},...t.map(e=>({[e.name]:e.value})))}function S(t){return JSON.stringify(b(t))}function $(t){return Array.isArray(t)?JSON.stringify(Object.assign({},...t.map(e=>({[e.name]:e.value})))):JSON.stringify(t)}function tt(t,e){return Object.keys(t).map(r=>e[r]?e[r][t[r]]:null).filter(r=>r!==null)}function et(t){return Object.assign({},...t.map(e=>({[$(e.selectedOptions||[])]:e})))}const I=["options","selectedOrFirstAvailableVariant","adjacentVariants"],nt=["handle","encodedVariantExistence","encodedVariantAvailability"];function m(t){return console.error(`[h2:error:getProductOptions] product.${t} is missing. Make sure you query for this field from the Storefront API.`),!1}function w(t,e=!1){var n;let r=!0;const o=Object.keys(t);if((e?[...I,...nt]:I).forEach(i=>{o.includes(i)||(r=m(i))}),t.options){const i=t==null?void 0:t.options[0];if(e&&!(i!=null&&i.name)&&(r=m("options.name")),(n=t==null?void 0:t.options[0])!=null&&n.optionValues){let s=t.options[0].optionValues[0];e&&!(s!=null&&s.name)&&(r=m("options.optionValues.name")),s=t.options[0].optionValues.filter(l=>!!(l!=null&&l.firstSelectableVariant))[0],s!=null&&s.firstSelectableVariant&&(r=E(s.firstSelectableVariant,"options.optionValues.firstSelectableVariant",r,e))}else r=m("options.optionValues")}return t.selectedOrFirstAvailableVariant&&(r=E(t.selectedOrFirstAvailableVariant,"selectedOrFirstAvailableVariant",r,e)),t.adjacentVariants&&t.adjacentVariants[0]&&(r=E(t.adjacentVariants[0],"adjacentVariants",r,e)),r?t:{}}function E(t,e,n,r){var o;let i=n;if(r&&!((o=t.product)!=null&&o.handle)&&(i=m(`${e}.product.handle`)),t.selectedOptions){const s=t.selectedOptions[0];s!=null&&s.name||(i=m(`${e}.selectedOptions.name`)),s!=null&&s.value||(i=m(`${e}.selectedOptions.value`))}else i=m(`${e}.selectedOptions`);return i}function rt(t){const e=w(t);if(!e.options)return[];const n={};e.options.map(o=>{var i;(i=o.optionValues)==null||i.map(s=>{if(s.firstSelectableVariant){const l=S(s.firstSelectableVariant.selectedOptions);n[l]=s.firstSelectableVariant}})}),e.adjacentVariants.map(o=>{const i=S(o.selectedOptions);n[i]=o});const r=e.selectedOrFirstAvailableVariant;if(r){const o=S(r.selectedOptions);n[o]=r}return Object.values(n)}function it(t){const e=w(t,!0);if(!e.options)return[];const{options:n,selectedOrFirstAvailableVariant:r,adjacentVariants:o,encodedVariantExistence:i,encodedVariantAvailability:s,handle:l}=e,u=r==null?void 0:r.selectedOptions.map(p=>p.name),c=n.filter(p=>u&&u.indexOf(p.name)>=0),d=Z(n),O=et(r?[r,...o]:o),h=b(r?r.selectedOptions:[]);return c.map((p,T)=>({...p,optionValues:p.optionValues.map(j=>{var V;const x={...h};x[p.name]=j.name;const U=$(x||[]),A=tt(x||[],d).slice(0,T+1),F=_(A,i||""),D=_(A,s||""),v=O[U]||j.firstSelectableVariant;let N={};v&&(N=b(v.selectedOptions||[]));const K=new URLSearchParams(N),y=((V=v==null?void 0:v.product)==null?void 0:V.handle)||l;return{...j,variant:v,handle:y,variantUriQuery:K.toString(),selected:h[p.name]===j.name,exists:F,available:D,isDifferentProduct:y!==l}})}))}function ot(t){return C.useEffect(()=>{const e=new URLSearchParams(b(t||[])),n=new URLSearchParams(window.location.search),r=new URLSearchParams({...Object.fromEntries(n),...Object.fromEntries(e)});r.size>0&&window.history.replaceState({},"",`${window.location.pathname}?${r.toString()}`)},[JSON.stringify(t)]),null}function st({image:t}){return t?a.jsx("div",{className:"product-image",children:a.jsx(z,{alt:t.altText||"Product Image",aspectRatio:"1/1",data:t,sizes:"(min-width: 45em) 50vw, 100vw"},t.id)}):a.jsx("div",{className:"product-image"})}function at({productOptions:t,selectedVariant:e}){const n=L(),{open:r}=k();return a.jsxs("div",{className:"product-form",children:[t.map(o=>o.optionValues.length===1?null:a.jsxs("div",{className:"product-options",children:[a.jsx("h5",{children:o.name}),a.jsx("div",{className:"variant-options-grid",children:o.optionValues.map(i=>{const{name:s,handle:l,variantUriQuery:u,selected:c,available:d,exists:O,isDifferentProduct:h,swatch:P}=i;return h?a.jsx(H,{className:`variant-option${c?" variant-option--selected":""}${d?"":" variant-option--disabled"}`,prefetch:"intent",preventScrollReset:!0,replace:!0,to:`/products/${l}?${u}`,children:a.jsx(R,{swatch:P,name:s})},o.name+s):a.jsx("button",{type:"button",className:`variant-option${c?" variant-option--selected":""}${d?"":" variant-option--disabled"}${O&&!c?" link":""}`,disabled:!O,onClick:()=>{c||n(`?${u}`,{replace:!0,preventScrollReset:!0})},children:a.jsx(R,{swatch:P,name:s})},o.name+s)})}),a.jsx("br",{})]},o.name)),a.jsx(M,{disabled:!e||!e.availableForSale,onClick:()=>{r("cart")},lines:e?[{merchandiseId:e.id,quantity:1,selectedVariant:e}]:[],children:e!=null&&e.availableForSale?"Add to cart":"Sold out"})]})}function R({swatch:t,name:e}){var o,i;const n=(i=(o=t==null?void 0:t.image)==null?void 0:o.previewImage)==null?void 0:i.url,r=t==null?void 0:t.color;return!n&&!r?e:a.jsx("div",{"aria-label":e,className:"product-option-label-swatch",style:{backgroundColor:r||"transparent"},children:!!n&&a.jsx("img",{src:n,alt:e})})}const ht=({data:t})=>[{title:`Hydrogen | ${(t==null?void 0:t.product.title)??""}`},{rel:"canonical",href:`/products/${t==null?void 0:t.product.handle}`}],jt=X(function(){const{product:e}=G(),n=J(e.selectedOrFirstAvailableVariant,rt(e));ot(n.selectedOptions);const r=it({...e,selectedOrFirstAvailableVariant:n}),{title:o,descriptionHtml:i}=e;return a.jsxs("div",{className:"product",children:[a.jsx(st,{image:n==null?void 0:n.image}),a.jsxs("div",{className:"product-main",children:[a.jsx("h1",{children:o}),a.jsx(q,{price:n==null?void 0:n.price,compareAtPrice:n==null?void 0:n.compareAtPrice}),a.jsx("br",{}),a.jsx(at,{productOptions:r,selectedVariant:n}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("p",{children:a.jsx("strong",{children:"Description"})}),a.jsx("br",{}),a.jsx("div",{dangerouslySetInnerHTML:{__html:i}}),a.jsx("br",{})]}),a.jsx(Q.ProductView,{data:{products:[{id:e.id,title:e.title,price:(n==null?void 0:n.price.amount)||"0",vendor:e.vendor,variantId:(n==null?void 0:n.id)||"",variantTitle:(n==null?void 0:n.title)||"",quantity:1}]}})]})});export{jt as default,ht as meta};
